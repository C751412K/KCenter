(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1042:function(t,e,a){"use strict";a.r(e);var n=a(1),r=a.n(n),o=a(56),i=a.n(o),c=a(67),l=a(39),s=a(54),u=a(22),p=a(435),m=a(164),f=a(162),d=a(23),h=a(66),y=a(16),b=a(128),g=a(47),v=a(30),E=a(68),w=a.n(E),S=a(21),P=a(187),O=a(310),C=a(142),x=a(53),I=a(236),k=a(107),j=a(99),R=a(33),D=a(14);function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function T(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function B(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?T(Object(a),!0).forEach((function(e){q(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function L(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function N(t,e,a){return e&&M(t.prototype,e),a&&M(t,a),t}function F(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}function A(t,e){return(A=Object.setPrototypeOf||function t(e,a){return e.__proto__=a,e})(t,e)}function H(t){var e=z();return function a(){var n=U(t),r;if(e){var o=U(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return V(this,r)}}function V(t,e){if(e&&("object"===_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return W(t)}function W(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)})(t)}function q(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var J=R.a.Row,K=R.a.Col,G=function(t){F(a,t);var e=H(a);function a(){var t;L(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return q(W(t=e.call.apply(e,[this].concat(r))),"state",{formValue:t.props.data,isMobile:!1,partition:t.props.data.partition,replica:t.props.data.replica,brokerList:[],sureDialog:!1,errormess:""}),q(W(t),"fetchBrokers",(function(){S.a.post("/manager/topic/broker_list",t.state.formValue).then((function(e){200===e.data.code&&t.setState({brokerList:e.data.data})})).catch((function(t){console.error(t)}))})),q(W(t),"onOk",(function(){""===t.state.errormess&&t.form.validateAll((function(e){e||(t.state.formValue.partition>=50?t.setState({sureDialog:!0}):t.sureAddPartition())}))})),q(W(t),"handelDialog",(function(){t.setState({errormess:""}),t.props.changeParationState()})),q(W(t),"closeSureDialog",(function(){t.setState({errormess:"",sureDialog:!1})})),q(W(t),"sureAddPartition",(function(){t.setState({errormess:"",sureDialog:!1});var e={};e.topicName=t.state.formValue.topicName,e.partition=t.state.formValue.partition,e.clusterId=t.state.formValue.clusterId,e.partitions=t.state.formValue.partitions.toString().replace("[").replace("]"),e.oldPartition=t.state.partition,S.a.post("/manager/topic/partition",e).then((function(e){200===e.data.code?(y.a.success(e.data.message),t.handelDialog(),t.props.refreshPage()):y.a.error(e.data.message)})).catch((function(t){console.error(t)}))})),q(W(t),"handelChange",(function(e){e.toString().split(",").length<t.state.replica&&0!==e.toString().length?t.setState({errormess:"You must select broker than replica count"}):t.setState({errormess:""})})),t}return N(a,[{key:"componentWillReceiveProps",value:function t(e){var a=e.visable;this.setState({visible:a,formValue:e.data,partition:e.data.partition,replica:e.data.replica},(function(){}))}},{key:"componentWillMount",value:function t(){this.fetchBrokers()}},{key:"render",value:function t(){var e=this,a=this.state.isMobile,n=B({},Y.simpleFormDialog);a&&(n.width="300px");var o={children:"OK"},i={children:"Cancel"};return r.a.createElement(g.a,{title:"Add Partitions",className:"simple-form-dialog",style:n,autoFocus:!1,footerAlign:"center",onOk:this.onOk,onCancel:this.handelDialog,onClose:this.handelDialog,isFullScreen:!0,visible:this.state.visible,okProps:o,cancelProps:i},r.a.createElement(g.a,{title:"Confirm the number of topics",visible:this.state.sureDialog,onCancel:this.closeSureDialog,onOk:this.sureAddPartition,onClose:this.closeSureDialog,okProps:o,cancelProps:i},"The number of topic partitions has exceeded 50"),r.a.createElement(D.FormBinderWrapper,{ref:function t(a){e.form=a},value:this.state.formValue,onChange:this.onFormChange},r.a.createElement("div",{style:Y.formContent},r.a.createElement(J,{style:Y.formItem},r.a.createElement(K,{span:"".concat("6"),style:Y.label},"Topic:"),r.a.createElement(K,{span:"".concat(a?"18":"16")},r.a.createElement(D.FormBinder,{name:"topicName"},r.a.createElement("span",{style:Y.inputItem},this.state.formValue.topicName)),r.a.createElement(D.FormError,{name:"topicName"}))),r.a.createElement(J,{style:Y.formItem},r.a.createElement(K,{span:"".concat("6"),style:Y.label},"Add to Partitions:"),r.a.createElement(K,{span:"".concat(a?"18":"16")},r.a.createElement(D.FormBinder,{name:"partition",validator:function t(a,n,r){var o=[];n<=e.state.partition&&o.push("Cannot add zero partitions topic"),r(o)}},r.a.createElement(k.a,{style:{width:"100%"}})),r.a.createElement(D.FormError,{name:"partition"}))),r.a.createElement(J,{style:Y.formItem},r.a.createElement(K,{span:"".concat("6"),style:Y.label},"Brokers:"),r.a.createElement(K,{span:"".concat(a?"18":"16")},r.a.createElement(D.FormBinder,{name:"partitions",required:!0,message:"Required"},r.a.createElement(x.a,{mode:"multiple",style:Y.inputItem,dataSource:this.state.brokerList,onChange:this.handelChange})),r.a.createElement("label",{style:Y.warnLabel},this.state.errormess),r.a.createElement(D.FormError,{name:"partitions"}))))))}}]),a}(n.Component),Y={container:{margin:"20px"},loading:{width:"100%",minHeight:"500px"},formContent:{alignItems:"center"},formItem:{alignItems:"center",position:"relative",marginTop:20},inputItem:{width:"100%"},simpleFormDialog:{width:"640px"},label:{textAlign:"left",paddingLeft:"5%",lineHeight:"26px"},warnLabel:{lineHeight:"26px",color:"red"}},Q;function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function tt(t,e,a){return e&&$(t.prototype,e),a&&$(t,a),t}function et(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&at(t,e)}function at(t,e){return(at=Object.setPrototypeOf||function t(e,a){return e.__proto__=a,e})(t,e)}function nt(t){var e=it();return function a(){var n=ct(t),r;if(e){var o=ct(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return rt(this,r)}}function rt(t,e){if(e&&("object"===X(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ot(t)}function ot(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function it(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)})(t)}function lt(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var st=Object(v.withRouter)(Q=function(t){et(a,t);var e=nt(a);function a(){var t;Z(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return lt(ot(t=e.call.apply(e,[this].concat(r))),"state",{configData:[],visable:!1,isMetricLoading:!1,metric:[],topicsummary:[],clusterName:""}),lt(ot(t),"fetchSummary",(function(){var e={topicName:t.props.match.params.topic,clusterId:t.props.match.params.clusterId};S.a.post("/manager/topic/summary",e).then((function(e){200===e.data.code&&t.mounted&&t.setState({topicsummary:e.data.data})})).catch((function(t){console.error(t)}))})),lt(ot(t),"fetchCluster",(function(){S.a.get("/cluster/get?id=".concat(t.props.match.params.clusterId)).then((function(e){200===e.data.code&&e.data.data&&t.mounted&&t.setState({clusterName:e.data.data.name})})).catch((function(t){console.error(t)}))})),lt(ot(t),"fetchData",(function(){var e={topicName:t.props.match.params.topic,clusterId:t.props.match.params.clusterId};S.a.post("/manager/topic/config",e).then((function(e){200===e.data.code&&t.mounted&&t.recombinat(e.data.data)})).catch((function(t){console.error(t)}))})),lt(ot(t),"addPartitions",(function(){t.setState({visable:!0})})),lt(ot(t),"deleteTopic",(function(){g.a.confirm({title:"Delete",content:"Do you want to delete this topic?",okProps:{children:"OK"},cancelProps:{children:"Cancel"},onOk:function e(){var a={topicName:t.props.match.params.topic,clusterId:parseInt(t.props.match.params.clusterId,10)};S.a.post("/manager/delete/topic",a).then((function(e){200===e.data.code?(y.a.success(e.data.message),t.handleCancel()):y.a.error(e.data.message)})).catch((function(t){console.error(t)}))}})})),lt(ot(t),"refreshPage",(function(){t.fetchSummary(),t.fetchData()})),lt(ot(t),"recombinat",(function(e){var a=[];Object.keys(e).forEach((function(t,n){"config"===t&&(a=e[t])})),t.setState({configData:a})})),lt(ot(t),"changeParationState",(function(){t.setState({visable:!t.state.visable})})),lt(ot(t),"updateConfig",(function(){t.props.history.push("/cluster/topic/config/".concat(t.props.match.params.clusterId,"/").concat(t.props.match.params.clusterName,"/").concat(t.props.match.params.topic))})),lt(ot(t),"fetchMetric",(function(){var e={topic:t.props.match.params.topic,clusterID:t.props.match.params.clusterId};t.setState({isMetricLoading:!0},(function(){S.a.defaults.timeout=18e4,S.a.post("/monitor/topic/consumer_offsets/topic_metric",e).then((function(e){200===e.data.code&&(e.data.data?t.mounted&&t.setState({metric:e.data.data,isMetricLoading:!1}):t.setState({isMetricLoading:!1}))})).catch((function(t){console.error(t)}))}))})),lt(ot(t),"handleCancel",(function(){t.props.history.push("/cluster/".concat(t.props.match.params.clusterId,"/").concat(t.props.match.params.clusterName,"/topic"))})),t}return tt(a,[{key:"componentWillMount",value:function t(){this.mounted=!0,this.fetchCluster(),this.fetchMetric(),this.fetchSummary(),this.fetchData()}},{key:"componentWillUnmount",value:function t(){this.mounted=!1}},{key:"render",value:function t(){var e=this,a=this.state.configData,n={topicName:this.props.match.params.topic,clusterId:this.props.match.params.clusterId},o=0;this.state.topicsummary.summary&&this.state.topicsummary.summary.forEach((function(t){"replication"===t.name&&(o=t.value)})),this.state.topicsummary.partition&&(n.partition=Object.keys(this.state.topicsummary.partition).length,n.replica=o);var c=function t(e,a,n){return"true"===e?r.a.createElement("font",{style:{backgroundColor:"#ffeeba"}},e):e};return r.a.createElement("div",null,r.a.createElement(i.a,{style:ut.container},r.a.createElement("div",null,r.a.createElement(G,{visable:this.state.visable,data:n,changeParationState:this.changeParationState,refreshPage:this.refreshPage}),r.a.createElement("div",{style:ut.listTitle},r.a.createElement(w.a,{onClick:function t(){return e.handleCancel()},style:ut.backward,size:"large",type:"backward"}),"cluster:\xa0",r.a.createElement("span",{style:ut.listTitles},this.state.clusterName," "),"\xa0\xa0topic:\xa0",r.a.createElement("span",{style:ut.listTitles},this.props.match.params.topic)),r.a.createElement(m.a,{style:ut.card,contentHeight:"auto"},r.a.createElement("div",{style:ut.title},"Topic Summary"),r.a.createElement(d.a,{dataSource:this.state.topicsummary.summary,hasHeader:!1},r.a.createElement(d.a.Column,{dataIndex:"name",width:150}),r.a.createElement(d.a.Column,{dataIndex:"value",width:150})),r.a.createElement("p",null)),r.a.createElement(O.a,{rolename:"admin"},r.a.createElement(m.a,{title:"Operations",style:ut.cards,contentHeight:"auto"},r.a.createElement(u.a,{type:"secondary",onClick:this.deleteTopic,style:ut.button},"Delete Topic"),"\xa0\xa0\xa0",r.a.createElement(u.a,{type:"secondary",style:ut.button,disabled:!0}," Reassign Partitions "),"\xa0\xa0\xa0",r.a.createElement(u.a,{type:"secondary",style:ut.button,disabled:!0},"Generate Partition Assignments"),r.a.createElement("br",null),r.a.createElement(u.a,{type:"secondary",onClick:this.addPartitions,style:ut.button},"Add Partitions"),"\xa0\xa0\xa0",r.a.createElement(u.a,{type:"secondary",onClick:this.updateConfig,style:ut.button},"Update Config"),"\xa0\xa0\xa0",r.a.createElement(u.a,{type:"secondary",style:ut.button,disabled:!0},"Manual Partition Assignments"))),r.a.createElement(m.a,{title:"Partitions by Broker",style:ut.cards,contentHeight:"auto"},r.a.createElement(d.a,{dataSource:this.state.topicsummary.broker},r.a.createElement(d.a.Column,{title:"Broker",dataIndex:"broker",width:50}),r.a.createElement(d.a.Column,{title:"# of Partitions",dataIndex:"partitions",width:50}),r.a.createElement(d.a.Column,{title:"# as Leader",dataIndex:"leaderCount",width:50}),r.a.createElement(d.a.Column,{title:"Partitions",dataIndex:"partition",width:100}),r.a.createElement(d.a.Column,{title:"Skewed?",dataIndex:"Skewed",width:100,cell:c}),r.a.createElement(d.a.Column,{title:"Leader Skewed?",dataIndex:"LeaderSkewed",width:100,cell:c})),r.a.createElement("div",{style:ut.title},"Topic Config"),r.a.createElement(d.a,{dataSource:a,hasHeader:!1},r.a.createElement(d.a.Column,{dataIndex:"config",width:150}),r.a.createElement(d.a.Column,{dataIndex:"value",width:150}))),r.a.createElement(m.a,{title:"Metric",style:ut.metriCard,contentHeight:"auto"},r.a.createElement(l.default,{visible:this.state.isMetricLoading,style:ut.loading},r.a.createElement(d.a,{dataSource:this.state.metric},r.a.createElement(d.a.Column,{title:"Rate",dataIndex:"metricName"}),r.a.createElement(d.a.Column,{title:"Mean",dataIndex:"meanRate",cell:P.b}),r.a.createElement(d.a.Column,{title:"1 min",dataIndex:"oneMinuteRate",cell:P.b}),r.a.createElement(d.a.Column,{title:"5 min",dataIndex:"fiveMinuteRate",cell:P.b}),r.a.createElement(d.a.Column,{title:"15 min",dataIndex:"fifteenMinuteRate",cell:P.b})))),r.a.createElement(m.a,{title:"Partition Information",contentHeight:"auto",style:ut.cardPartition},r.a.createElement(d.a,{dataSource:this.state.topicsummary.partition},r.a.createElement(d.a.Column,{title:"Partition",dataIndex:"partition",width:100}),r.a.createElement(d.a.Column,{title:"Leader",dataIndex:"leader",width:100}),r.a.createElement(d.a.Column,{title:"Replicas",dataIndex:"replicas",width:150}),r.a.createElement(d.a.Column,{title:"In Sync Replicas",dataIndex:"InSyncReplicas",width:150}),r.a.createElement(d.a.Column,{title:"Preferred Leader?",dataIndex:"Preferred_Leader",width:150}),r.a.createElement(d.a.Column,{title:"Under Replicated?",dataIndex:"Under_Replicated",width:150}))))))}}]),a}(n.Component))||Q,ut={title:{fontSize:"18px",marginTop:"10px"},card:{width:"50%",height:"100%",float:"left",marginTop:"0px !important"},cards:{width:"50%",height:"100%",float:"right",marginTop:"0px !important"},cardPartition:{width:"100%",height:"100%"},button:{marginBottom:"10px",marginRight:"5px"},loading:{width:"100%"},backward:{display:"inline-block",minWidth:"40px",cursor:"pointer",color:"#0066FF"},listTitle:{marginBottom:"10px",fontSize:"30px"},listTitles:{marginBottom:"10px",fontSize:"30px",fontWeight:"bold"},metriCard:{width:"50%",height:"100%"}};function pt(t){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(e){return typeof e}:function t(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ft(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function dt(t,e,a){return e&&ft(t.prototype,e),a&&ft(t,a),t}function ht(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yt(t,e)}function yt(t,e){return(yt=Object.setPrototypeOf||function t(e,a){return e.__proto__=a,e})(t,e)}function bt(t){var e=Et();return function a(){var n=wt(t),r;if(e){var o=wt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return gt(this,r)}}function gt(t,e){if(e&&("object"===pt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return vt(t)}function vt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Et(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)})(t)}var St=function(t){ht(a,t);var e=bt(a);function a(){return mt(this,a),e.apply(this,arguments)}return dt(a,[{key:"render",value:function t(){return r.a.createElement("div",null,r.a.createElement(i.a,{style:Pt.container},r.a.createElement(st,null)))}}]),a}(n.Component),Pt={container:{margin:"20px",padding:"10px 20px 20px"}},Ot=e.default=St}}]);